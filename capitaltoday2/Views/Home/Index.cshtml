@{
    ViewBag.Title = "Capital.Today";
}

<div id="homePage">
    <section id="mainSection" class="fullScreenSection">

       <img id="logoImage" src="~/Content/images/logo.png" alt="logo" />


        <div class="flexDiv">
            <div class="columnWide">
                <div id="frontPageText">
                    <h1>30 Years Experience in Helping Borrowers Find Capital and Capital Find Borrowers. </h1>
                    <h1>Strong and Dedicated Team at Work for You.</h1>
                </div>
            </div>

            <div class="columnNarrow">
                <div id="mainQuestion" class="questionList">
                    <h2>How Can We Help?</h2>

                    <button id="refinanceBtn" class="orangeButton">Refinance</button>
                    <p>Or</p>
                    <button id="acquistionBtn" class="greenButton">Acquisition</button>
                </div>

                <!--======================Refinance question1=========================-->

                <div id="refinanceQuestion1" class="questionList">
                    <div class="form-group row">
                        <p>What is the Current <strong>Market Value</strong>?</p>
                        <input type="text" id="marketValue" name="marketValue" class="refinanceQuestion1 required" />
                        <p id="marketValueError" class="displayError">Please enter market value</p>
                    </div>
                    <div class="form-group row">
                        <p>What is the Current <strong>Loan Balance</strong>?</p>
                        <input type="text" id="loanBalance" name="loanBalance" class="refinanceQuestion1 required" />
                        <p id="loanBalanceError" class="displayError">Please enter loan balance</p>
                    </div>
                    <div class="navigationButtons">
                        <button id="refiBtn1" class="nextBtn">Next</button>
                    </div>
               </div>

                <!--======================Shared question2=========================-->
                <div id="sharedQuestion2" class="questionList">
                    <div class="form-group row" name="propertytype">
                        <p>What is your <strong>Property Type</strong>?</p>

                        <div class="checkbox" id="multifamilyQuestion">
                            <label><input type="checkbox" name="propertyType" value="multifamily" class="sharedQuestion2 propertyTypeSelect required">Multifamily</label>
                        </div>
                        <div class="displayNone" id="unitsNumber">
                            <label>How many units?</label>
                            <input id="unitsNumberTextbox" type="number" min="0" name="unitsNumber" class="sharedQuestion2" />
                            <p id="unitsNumberError" class="displayError">Please enter number of units</p>
                        </div>
                        
                        <div class="checkbox">
                            <label><input type="checkbox" name="propertyType" value="mixeduse" class="sharedQuestion2 propertyTypeSelect required">Mixed Use</label>
                        </div>
                        <div class="checkbox">
                            <label><input type="checkbox" name="propertyType" value="industrial" class="sharedQuestion2 propertyTypeSelect required">Industrial</label>
                        </div>
                        <div class="checkbox">
                            <label><input type="checkbox" name="propertyType" value="office" class="sharedQuestion2 propertyTypeSelect required">Office</label>
                        </div>
                        <div class="checkbox">
                            <label><input type="checkbox" name="propertyType" value="retail" class="sharedQuestion2 propertyTypeSelect required">Retail</label>
                        </div>
                        <div class="checkbox" id="otherQuestion">
                            <label><input type="checkbox" name="propertyType" value="other" class="sharedQuestion2 propertyTypeSelect required">Other</label>
                        </div>
                        <div class="displayNone" id="otherDescription">
                            <label>Enter a short description up to 25 characters</label>
                            <textarea id="otherTextarea" maxlength="25"></textarea>
                            <p id="otherTextareaError" class="displayError">Please enter description</p>
                        </div>
                        
                        <p id="propertyTypeError" class="displayError">Please select the property type</p>
                    </div>

                   
                    <div class="form-group row">
                        <p>What state is the property located in?</p>
                        <select class="form-control" id="stateSelect" name="state">                  
                            <option disabled selected value="">Select state</option>
                            <option value="AK">Alaska</option>
                            <option value="AL">Alabama</option>
                            <option value="AR">Arkansas</option>
                            <option value="AZ">Arizona</option>
                            <option value="CA">California</option>
                            <option value="CO">Colorado</option>
                            <option value="CT">Connecticut</option>
                            <option value="DC">District of Columbia</option>
                            <option value="DE">Delaware</option>
                            <option value="FL">Florida</option>
                            <option value="GA">Georgia</option>
                            <option value="HI">Hawaii</option>
                            <option value="IA">Iowa</option>
                            <option value="ID">Idaho</option>
                            <option value="IL">Illinois</option>
                            <option value="IN">Indiana</option>
                            <option value="KS">Kansas</option>
                            <option value="KY">Kentucky</option>
                            <option value="LA">Louisiana</option>
                            <option value="MA">Massachusetts</option>
                            <option value="MD">Maryland</option>
                            <option value="ME">Maine</option>
                            <option value="MI">Michigan</option>
                            <option value="MN">Minnesota</option>
                            <option value="MO">Missouri</option>
                            <option value="MS">Mississippi</option>
                            <option value="MT">Montana</option>
                            <option value="NC">North Carolina</option>
                            <option value="ND">North Dakota</option>
                            <option value="NE">Nebraska</option>
                            <option value="NH">New Hampshire</option>
                            <option value="NJ">New Jersey</option>
                            <option value="NM">New Mexico</option>
                            <option value="NV">Nevada</option>
                            <option value="NY">New York</option>
                            <option value="OH">Ohio</option>
                            <option value="OK">Oklahoma</option>
                            <option value="OR">Oregon</option>
                            <option value="PA">Pennsylvania</option>
                            <option value="PR">Puerto Rico</option>
                            <option value="RI">Rhode Island</option>
                            <option value="SC">South Carolina</option>
                            <option value="SD">South Dakota</option>
                            <option value="TN">Tennessee</option>
                            <option value="TX">Texas</option>
                            <option value="UT">Utah</option>
                            <option value="VA">Virginia</option>
                            <option value="VT">Vermont</option>
                            <option value="WA">Washington</option>
                            <option value="WI">Wisconsin</option>
                            <option value="WV">West Virginia</option>
                            <option value="WY">Wyoming</option>
                        </select>
                        <p id="stateError" class="displayError">Please select the state</p>
                    </div>
                    <div class="navigationButtons">
                        <button id="Btn2" class="nextBtn">Next</button>
                    </div>
                 </div>
                    
                <div id="sharedQuestion3" class="questionList">
                    <div class="form-group row">
                        <p>First name:</p>
                        <input type="text" id="name" class="required sharedQuestion3" name="name" value="">
                        <p id="nameError" class="displayError">Please enter your valid first name</p>
                    </div>
                    <div class="form-group row">
                        <p>Email:</p>
                        <input type="text" id="email" class="required sharedQuestion3" name="email" value="">
                        <p id="emailError" class="displayError">Please enter a valid email</p>
                    </div>
                    <div class="form-group row">
                        <p>Phone:</p>
                        <input type="text" id="phone" class="required sharedQuestion3" name="phone" value="">
                        <p id="phoneError" class="displayError">Please enter a valid phone number</p>
                    </div>
                    <div class="form-group row termsRow">
                        <div class="checkboxWrapper">
                            <div class="checkbox">
                                <input type="checkbox" id="termsCheckbox" name="termsCheckbox" class="required sharedQuestion3">
                                <label>
                                    I agree to terms and conditions
                                </label>
                            </div>
                            <p id="termsError" class="displayError">You haven't agreed to terms</p>
                        </div>
                    </div>
                    <p id="defaultError" class="displayError">Something went wrong</p>
                    <button id="submitButton" class="greenButton">Submit</button>
                </div>


                <!--======================Acquisition question1=========================-->

                <div id="acquisitionQuestion1" class="questionList">
                    <div class="form-group row">
                        <p>What is the <strong>Purchase Price</strong>?</p>
                        <input type="text" min="0" id="purchasePrice" name="purchasePrice" class="acquisitionQuestion1 required" />
                        <p id="purchasePriceError" class="displayError">Please enter purchase price</p>
                    </div>
                    <div class="form-group row">
                        <p>What is the <strong>Requested Loan Amount</strong>?</p>
                        <input type="text" min="0" id="requestedLoanAmount" name="requestedLoanAmount" class="acquisitionQuestion1 required" />
                        <p id="requestedLoanError" class="displayError">Please enter requested loan amount</p>
                    </div>
                    <div class="navigationButtons">
                        <button id="acquisitionBtn1" class="nextBtn">Next</button>
                    </div>
                </div>

                <div id="thankYouMessage" class="displayNone">
                    <p>Thank you for your submission!</p>
                    <p>Our representative will be in touch with you shortly. For any urgent matters you can contact our staff directly at 888-555-1212</p>
                </div>
            </div>
        </div>
    </section>
    <section id="commercialDeals">
        <h2>We Specialize in Commercial Deals:</h2>
        <div id="loanDescriptionRow" class="row flexDiv">
            <div class="flexColumn">
                <div class="loanList ">
                    <p>Bridge Loans</p>
                    <p>Business Acquisition Loans</p>
                    <p>CMBS Loans</p>
                    <p>Commercial Condo Loans</p>
                    <p>Commercial Co-op Loans</p>
                    <p>Commercial Equipment Loans</p>
                    <p>Commercial Lines of Credit</p>
                    <p>Commercial Warehouse Loans</p>
                </div>
            </div>
            <div class="flexColumn">
                <div class="loanList">
                    <p>Commercial Working Capital Financing</p>
                    <p>Condo Construction Loans</p>
                    <p>Condo Conversion Loans</p>
                    <p>Condo Inventory Loans</p>
                    <p>Construction Loan</p>
                    <p>Debt Restructuring</p>
                    <p>Development Loans 44</p>
                    <p>Distressed Commercial Property Loans</p>
                </div>
            </div>
            <div class="flexColumn">
                <div class="loanList">
                    <p>Finance Acquisitions</p>
                    <p>Hard Money Loans</p>
                    <p>Land Loans</p>
                    <p>Mixed Use Property Loans</p>
                    <p>Mortgages</p>
                    <p>Multi Family Construction Loans</p>
                    <p>Multi Family Loans</p>
                    <p>Non Stabilized Commercial Property Loans</p>
                </div>
            </div>
            <div class="flexColumn">
                <div class="loanList">
                    <p>Office Building Loans</p>
                    <p>owner occupied commercial loans</p>
                    <p>refinance</p>
                    <p>retail condo loans</p>
                    <p>sba 504</p>
                    <p>sba 7a</p>
                    <p>sba financing</p>
                    <p>straight loans</p>
                </div>
            </div>
        </div>
        <div id="commercialDealsPicture">
        </div>

        <div>
            <div id="blueDivs" class="flexDiv">
                <div class="snippet">
                    <img class="icon" src="~/Content/images/iconbag.png" alt="money bag icon" />
                    <h3>Loan Size</h3>
                    <p>$1.0 MM - $15.0 MM</p>
                    <div class="emptyDiv"></div>
                    <img class="icon" src="~/Content/images/iconcircle.png" alt="money circulation icon" />
                    <h3>Term</h3>
                    <p>From 6 months to 3 years</p>
                </div>
                <div class="verticalSeparator"></div>
                <div class="snippet">
                    <img class="icon" src="~/Content/images/iconcalc.png" alt="calculator icon" />
                    <h3>Rates</h3>
                    <p>From 9.0%-11%</p>
                    <div class="emptyDiv"></div>
                    <img class="icon" src="~/Content/images/iconsquare.png" alt="safe icon" />
                    <h3>Security</h3>
                    <p>First Mortgage Lien</p>
                </div>
                <div class="verticalSeparator"></div>
                <div class="snippet">
                    <img class="icon" src="~/Content/images/iconhouse.png" alt="house icon" />
                    <h3>LTV</h3>
                    <p>Up to 80%</p>
                    <div class="emptyDiv"></div>
                    <img class="icon" src="~/Content/images/iconpercent.png" alt="percentage icon" />
                    <h3>Origination Fee</h3>
                    <p>2%-6%</p>
                </div>
            </div>
            <div id="greenDivs" class="flexDiv">
                <div class="snippet">
                    <img class="icon" src="~/Content/images/clock.png" alt="money icon" />
                    <h3>Quick Turnaround</h3>
                    <p class="smallFont">
                        Time is money. It is in everyone's interest to provide you with funding as soon as possible. We work diligently and efficiently.
                    </p>
                </div>
                <div class="verticalSeparator"></div>
                <div class="snippet">
                    <img class="icon" src="~/Content/images/iconlist.png" alt="list icon" />
                    <h3>Best Terms</h3>
                    <p class="smallFont">30 years of experience offer us access to the lowest rates in the industry.  We will beat our competition. </p>
                </div>
                <div class="verticalSeparator"></div>
                <div class="snippet">
                    <img class="icon" src="~/Content/images/iconbroker.png" alt="money icon" />
                    <h3>Brokers Welcome</h3>
                    <p class="smallFont">We pay commission to brokers on all new deals and closed loans. We welcome brokers submissions.</p>
                </div>
            </div>
            <div id="addressRow" class="row text-center">
                <h3>Main Address:</h3>
                <h4>Avolar Capital</h4>
                <p>600 3rd Ave, 2nd Floor</p>
                <p>New York, NY 10016</p>
                <p>888-555-1212</p>
            </div>
        </div>
    </section>
</div>

@section scripts {
    <script>
        $(document).ready(function () {
            var refinance;
            //$('#commercialDealsPicture').css('height', $(window).height() - $('#loanDescriptionRow').height() - $('#commercialDeals h2').height());
            //refinance
            //$('#refinanceBtn').click(function () {
            //    alert('ff');
            //});
            document.getElementById('refinanceBtn').addEventListener('click', function (e) {
                $('#mainQuestion').addClass('opacityNone');
                $('#refinanceQuestion1').addClass('opacityFull');
                if ($(window).width() < 768) {
                    $('#frontPageText').hide();
                }             
                refinance = true;
            });
            //acquisition
            document.getElementById('acquistionBtn').addEventListener('click', function (e) {
                //$('#mainQuestion').slideUp();
                //$('#acquisitionQuestion1').slideDown();
                $('#mainQuestion').addClass('opacityNone');
                $('#acquisitionQuestion1').addClass('opacityFull');
                if ($(window).width() < 768) {
                    $('#frontPageText').hide();
                }
                refinance = false;
            });

       

        //$('.nextBtn').click(function () {
        //    var requiredFields = $(this).closest('.questionList').find('.required');
        //    $(requiredFields).each(function () {
        //        if ($(this).val().length == 0) {
        //            $(this).closest('.form-group').find('.displayError').show();
        //        };
        //    });
        //});

        ///////////////////////////refinance question 1//////////////////////////////
        document.getElementById('refiBtn1').addEventListener('click', function (e) {
            var valid = false;

            $('.refinanceQuestion1').each(function (index, element) {
                let name = $(element).attr('name');
                let value = $(element).val();
                switch (name) {
                    case "marketValue":

                        if (isNumber(value) === true) {
                            document.getElementById('marketValueError').style.display = 'none';
                            valid = true;
                            console.log('mv' + valid);
                        }
                        else {
                            document.getElementById('marketValueError').style.display = 'block';
                            valid = false;
                        }
                        break;
                    case "loanBalance":

                        if (isNumber(value) === true) {
                            document.getElementById('loanBalanceError').style.display = 'none';
                            valid = true;
                            console.log('lb' + valid);
                        }
                        else {
                            document.getElementById('loanBalanceError').style.display = 'block';
                            valid = false;
                        }
                        break;
                }
            });

            if (valid) {
                $('#refinanceQuestion1').addClass('opacityNone');
                $('#sharedQuestion2').addClass('opacityFull');
            }
           
        });


        ///////////////////////////acquisition question 1//////////////////////////////
        document.getElementById('acquisitionBtn1').addEventListener('click', function (e) {
            var valid = true;

            $('.acquisitionQuestion1').each(function (index, element) {
                let name = $(element).attr('name');
                let value = $(element).val();
                switch (name) {
                    case "purchasePrice":
                        if (isNumber(value) === true) {
                            document.getElementById('purchasePriceError').style.display = 'none';
                            valid = true;                        
                        }
                        else {
                            document.getElementById('purchasePriceError').style.display = 'block';
                            valid = false;
                        }
                        break;
                    case "requestedLoanAmount":

                        if (isNumber(value) === true) {
                            document.getElementById('requestedLoanError').style.display = 'none';
                            valid = true;                     
                        }
                        else {
                            document.getElementById('requestedLoanError').style.display = 'block';
                            valid = false;
                        }
                        break;
                }
            });

            if (valid) {
                $('#acquisitionQuestion1').addClass('opacityNone');
                $('#sharedQuestion2').addClass('opacityFull');
            }

        });


        ///////////////// question 2/////////////////////////////

        document.getElementById('Btn2').addEventListener('click', function (e) {
            let validCheckbox = true;
            let validSelectbox = true;
            let checkboxes = document.getElementsByClassName('propertyTypeSelect');
            //let checkedOne = Array.prototype.slice.call(checkboxes).some(x => x.checked);
            var checkedOne = false;
            for (var i = 0, l = checkboxes.length; i < l; i++) {
                if (checkboxes[i].checked) {
                    checkedOne = true;
                    break;
                }
            }
            let stateSelectbox = document.getElementById('stateSelect');

            if (checkedOne == true) {
                var checkedValue = document.querySelector('.propertyTypeSelect:checked').value;
                if (checkedValue == 'multifamily') {
                    if (document.getElementById('unitsNumberTextbox').value == "" || document.getElementById('unitsNumberTextbox').value == "undefined") {
                        $('#unitsNumberError').show();
                        validCheckbox = false;
                    }
                    else {
                        $('#unitsNumberError').hide();
                        validCheckbox = true;
                    }
                }
                else if (checkedValue == 'other') {
                    if (document.getElementById('otherTextarea').value == "") {
                        $('#otherTextareaError').show();
                        validCheckbox = false;
                    }
                    else {
                        $('#otherTextareaError').hide();
                        validCheckbox = true;
                    }
                }
                else {
                    validCheckbox = true;
                }
          
                document.getElementById('propertyTypeError').style.display = 'none';
            }
            else {
                validCheckbox = false;
                document.getElementById('propertyTypeError').style.display = 'block';
            }

            
            if (stateSelectbox.selectedIndex != 0) {
                document.getElementById('stateError').style.display = 'none';
                validSelectbox = true;
            }
            else {
                document.getElementById('stateError').style.display = 'block';
                validSelectbox = false;
            }

            if (validCheckbox && validSelectbox) {
                $('#sharedQuestion2').addClass('opacityNone');
                $('#sharedQuestion3').addClass('opacityFull');
            }
          
        });

        //on click of checkbox to select property type, unselect other values, show additional fields
        $('.propertyTypeSelect').change(function () {
            $('input[name="propertyType"]').not(this).prop('checked', false);
            var checkedValue = document.querySelector('.propertyTypeSelect:checked').value;
            if (checkedValue == 'multifamily') {
                document.getElementById('unitsNumber').style.display = 'block';
                document.getElementById('otherDescription').style.display = 'none';
            }
            else if (checkedValue == 'other') {
                document.getElementById('otherDescription').style.display = 'block';
                document.getElementById('unitsNumber').style.display = 'none';
            }
            else {
                document.getElementById('unitsNumber').style.display = 'none';
                document.getElementById('otherDescription').style.display = 'none';
            }
        });


        ///////////////////////////// question 3//////////////////////////////////
        document.getElementById('submitButton').addEventListener('click', function (e) {
            var valid = true;

            $('.sharedQuestion3').each(function (index, element) {
                let name = $(element).attr('name');
                let value = $(element).val();
                switch (name) {
                    case "name":
                        if (value.length < 2 || value == null) {
                            document.getElementById('nameError').style.display = 'block';
                            valid = false;
                        }
                        else {
                            document.getElementById('nameError').style.display = 'none';
                            valid = true;
                        }
                        break;
                    case "email":
                        if (!validateEmail(value)) {
                            document.getElementById('emailError').style.display = 'block';
                            valid = false;
                        }
                        else {
                            document.getElementById('emailError').style.display = 'none';
                            valid = true;
                        }
                        break;
                    case "phone":
                        if (!validatePhone(value)) {
                            document.getElementById('phoneError').style.display = 'block';
                            valid = false;
                        }
                        else {
                            document.getElementById('phoneError').style.display = 'none';
                            valid = true;
                        }
                        break;
                    case "termsCheckbox":
                        if (document.getElementById('termsCheckbox').checked == false) {
                            document.getElementById('termsError').style.display = 'block';
                            valid = false;
                        }
                        else {
                            document.getElementById('termsError').style.display = 'none';
                            valid = true;
                        }
                        break;
                    default:
                        if (value == '' || value == null) {
                            valid = false;
                            document.getElementById('defaultError').style.display = 'block';
                        }
                        break;
                }
            });
            if (valid) {
                submitAccount();
            }
        });

        function submitAccount() {
            console.log(refinance);
            let state = document.getElementById("stateSelect");
            let stateValue = state.options[state.selectedIndex].text;
            let url;
            let data = {};
            if (refinance == true) {
                url = '/Home/submitRefinanceAccount';               
                data.MarketValue = document.getElementById('marketValue').value;
                data.LoanBalance = document.getElementById('loanBalance').value;                    
            }
            else {
                url = '/Home/submitAcquisitionAccount';
                data.PurchasePrice = document.getElementById('purchasePrice').value;
                data.RequestedLoanAmount = document.getElementById('requestedLoanAmount').value;
            }
               
            data.PropertyType = document.querySelector('.propertyTypeSelect:checked').value;
            data.UnitNumber = document.getElementById('unitsNumberTextbox').value || "";
            data.OtherDescription = document.getElementById('otherDescription').value || "";
            data.PropertyState = stateValue;
            data.Name = document.getElementById('name').value;
            data.Email = document.getElementById('email').value;
            data.Phone = document.getElementById('phone').value;
            console.log(url);

            $.ajax({
                url: url,            
                type: 'POST',
                dataType: 'json',
                data: data
            }).success(function (response) {
                console.log('success');
                $('#sharedQuestion3').addClass('opacityNone');
                $('#thankYouMessage').addClass('opacityFull');
                $('#frontPageText').show();
            }).error(function (response) {
                console.log('error');
                console.log(response);
                $('#sharedQuestion3').addClass('opacityNone');
                $('#thankYouMessage').addClass('opacityFull');
                $('#frontPageText').show();
            });
        }


        function isNumber(input) {
            if (input) {
                var reg = /^[0-9,.]*$/;
                return reg.test(input);
            }
            else {
                return false;
            }
        }
        
        function validatePhone(phone) {
            if (phone) {
                //var reg = /^[(]{0,1}[0-9]{3}[)]{0,1}[-\s\.]{0,1}[0-9]{3}[-\s\.]{0,1}[0-9]{4}$/;
                var reg = /^[\+]?[(]?[0-9]{3}[)]?[-\s\.]?[0-9]{3}[-\s\.]?[0-9]{4,6}$/;
                if (reg.test(phone)) {
                    //return emailExist(email);
                    return true;
                }
            }
            return false;
        }

        function validateEmail(email) {
            if (email) {
                var reg = /^(([^<>()[\]\\.,;:\s@@\"]+(\.[^<>()[\]\\.,;:\s@@\"]+)*)|(\".+\"))@@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
                if (reg.test(email)) {
                    //return emailExist(email);
                    return true;
                }
            }
            return false;
        }


    });
    </script>
}